{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import os\n",
    "from tqdm import tqdm_notebook as tpdm\n",
    "from joblib import Parallel, delayed"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['mulliken_charges.csv',\n",
       " 'test.csv',\n",
       " 'structures.csv',\n",
       " 'dipole_moments.csv',\n",
       " 'structures',\n",
       " 'potential_energy.csv',\n",
       " 'train.csv',\n",
       " 'scalar_coupling_contributions.csv',\n",
       " 'magnetic_shielding_tensors.csv',\n",
       " 'sample_submission.csv']"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "input_files = os.listdir('../input')\n",
    "input_files"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "train_df = pd.read_csv('../input/train.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>molecule_name</th>\n",
       "      <th>atom_index_0</th>\n",
       "      <th>atom_index_1</th>\n",
       "      <th>type</th>\n",
       "      <th>scalar_coupling_constant</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1JHC</td>\n",
       "      <td>84.8076</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2JHH</td>\n",
       "      <td>-11.2570</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2JHH</td>\n",
       "      <td>-11.2548</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>2JHH</td>\n",
       "      <td>-11.2543</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1JHC</td>\n",
       "      <td>84.8074</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id     molecule_name  atom_index_0  atom_index_1  type  \\\n",
       "0   0  dsgdb9nsd_000001             1             0  1JHC   \n",
       "1   1  dsgdb9nsd_000001             1             2  2JHH   \n",
       "2   2  dsgdb9nsd_000001             1             3  2JHH   \n",
       "3   3  dsgdb9nsd_000001             1             4  2JHH   \n",
       "4   4  dsgdb9nsd_000001             2             0  1JHC   \n",
       "\n",
       "   scalar_coupling_constant  \n",
       "0                   84.8076  \n",
       "1                  -11.2570  \n",
       "2                  -11.2548  \n",
       "3                  -11.2543  \n",
       "4                   84.8074  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['1JHC', '2JHH', '1JHN', '2JHN', '2JHC', '3JHH', '3JHC', '3JHN'],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_df['type'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x7f42a7cac2e8>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "train_df['atom_index_0'].plot.hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,\n",
       "       18, 19, 20, 21, 22, 23, 24, 25, 26,  0, 27, 28])"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_df['atom_index_0'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x7f42a34d4dd8>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "train_df['atom_index_1'].plot.hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([ 0,  2,  3,  4,  1,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,\n",
       "       18, 19, 17, 20, 21, 22, 24, 25, 23, 26, 27, 28])"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_df['atom_index_1'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x7f42a798b4a8>"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "train_df['scalar_coupling_constant'].plot.hist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "structure_df = pd.read_csv('../input/structures.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>molecule_name</th>\n",
       "      <th>atom_index</th>\n",
       "      <th>atom</th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "      <th>z</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>0</td>\n",
       "      <td>C</td>\n",
       "      <td>-0.012698</td>\n",
       "      <td>1.085804</td>\n",
       "      <td>0.008001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>1</td>\n",
       "      <td>H</td>\n",
       "      <td>0.002150</td>\n",
       "      <td>-0.006031</td>\n",
       "      <td>0.001976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>2</td>\n",
       "      <td>H</td>\n",
       "      <td>1.011731</td>\n",
       "      <td>1.463751</td>\n",
       "      <td>0.000277</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>3</td>\n",
       "      <td>H</td>\n",
       "      <td>-0.540815</td>\n",
       "      <td>1.447527</td>\n",
       "      <td>-0.876644</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>4</td>\n",
       "      <td>H</td>\n",
       "      <td>-0.523814</td>\n",
       "      <td>1.437933</td>\n",
       "      <td>0.906397</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      molecule_name  atom_index atom         x         y         z\n",
       "0  dsgdb9nsd_000001           0    C -0.012698  1.085804  0.008001\n",
       "1  dsgdb9nsd_000001           1    H  0.002150 -0.006031  0.001976\n",
       "2  dsgdb9nsd_000001           2    H  1.011731  1.463751  0.000277\n",
       "3  dsgdb9nsd_000001           3    H -0.540815  1.447527 -0.876644\n",
       "4  dsgdb9nsd_000001           4    H -0.523814  1.437933  0.906397"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "structure_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(2358657, 6)"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "structure_df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>molecule_name</th>\n",
       "      <th>atom_index_0</th>\n",
       "      <th>atom_index_1</th>\n",
       "      <th>type</th>\n",
       "      <th>scalar_coupling_constant</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1JHC</td>\n",
       "      <td>84.8076</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2JHH</td>\n",
       "      <td>-11.2570</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2JHH</td>\n",
       "      <td>-11.2548</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>2JHH</td>\n",
       "      <td>-11.2543</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1JHC</td>\n",
       "      <td>84.8074</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id     molecule_name  atom_index_0  atom_index_1  type  \\\n",
       "0   0  dsgdb9nsd_000001             1             0  1JHC   \n",
       "1   1  dsgdb9nsd_000001             1             2  2JHH   \n",
       "2   2  dsgdb9nsd_000001             1             3  2JHH   \n",
       "3   3  dsgdb9nsd_000001             1             4  2JHH   \n",
       "4   4  dsgdb9nsd_000001             2             0  1JHC   \n",
       "\n",
       "   scalar_coupling_constant  \n",
       "0                   84.8076  \n",
       "1                  -11.2570  \n",
       "2                  -11.2548  \n",
       "3                  -11.2543  \n",
       "4                   84.8074  "
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "  0%|          | 363/4658147 [00:03<9:59:52, 129.41it/s] "
     ]
    },
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-67-2617b10a06ed>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      8\u001b[0m         \u001b[0mmolecule_name\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mstructure_df\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mstructure_df\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'molecule_name'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0mmolecule\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      9\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 10\u001b[0;31m     \u001b[0mxyz_0\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmolecule_name\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mrow\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;36m6\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     11\u001b[0m     \u001b[0mxyz_1\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmolecule_name\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mrow\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m3\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;36m6\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     12\u001b[0m     \u001b[0mX\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlinalg\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnorm\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mxyz_1\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0mxyz_0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.pyenv/versions/anaconda3-5.3.1/lib/python3.7/site-packages/pandas/core/generic.py\u001b[0m in \u001b[0;36mvalues\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   4631\u001b[0m         \"\"\"\n\u001b[1;32m   4632\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_consolidate_inplace\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 4633\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_data\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mas_array\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtranspose\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_AXIS_REVERSED\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   4634\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   4635\u001b[0m     \u001b[0;34m@\u001b[0m\u001b[0mproperty\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.pyenv/versions/anaconda3-5.3.1/lib/python3.7/site-packages/pandas/core/internals.py\u001b[0m in \u001b[0;36mas_array\u001b[0;34m(self, transpose, items)\u001b[0m\n\u001b[1;32m   3947\u001b[0m             \u001b[0marr\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmgr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mblocks\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_values\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3948\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 3949\u001b[0;31m             \u001b[0marr\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmgr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_interleave\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   3950\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3951\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0marr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtranspose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mtranspose\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0marr\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.pyenv/versions/anaconda3-5.3.1/lib/python3.7/site-packages/pandas/core/internals.py\u001b[0m in \u001b[0;36m_interleave\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   3956\u001b[0m         \u001b[0mItems\u001b[0m \u001b[0mmust\u001b[0m \u001b[0mbe\u001b[0m \u001b[0mcontained\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mthe\u001b[0m \u001b[0mblocks\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3957\u001b[0m         \"\"\"\n\u001b[0;32m-> 3958\u001b[0;31m         \u001b[0mdtype\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_interleaved_dtype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mblocks\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   3959\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3960\u001b[0m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mempty\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdtype\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.pyenv/versions/anaconda3-5.3.1/lib/python3.7/site-packages/pandas/core/internals.py\u001b[0m in \u001b[0;36m_interleaved_dtype\u001b[0;34m(blocks)\u001b[0m\n\u001b[1;32m   5046\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5047\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 5048\u001b[0;31m     \u001b[0mdtype\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfind_common_type\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mb\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdtype\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mb\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mblocks\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   5049\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   5050\u001b[0m     \u001b[0;31m# only numpy compat\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.pyenv/versions/anaconda3-5.3.1/lib/python3.7/site-packages/pandas/core/dtypes/cast.py\u001b[0m in \u001b[0;36mfind_common_type\u001b[0;34m(types)\u001b[0m\n\u001b[1;32m   1139\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mobject\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1140\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1141\u001b[0;31m     \u001b[0;32mreturn\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfind_common_type\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtypes\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1142\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1143\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.pyenv/versions/anaconda3-5.3.1/lib/python3.7/site-packages/numpy/core/numerictypes.py\u001b[0m in \u001b[0;36mfind_common_type\u001b[0;34m(array_types, scalar_types)\u001b[0m\n\u001b[1;32m   1002\u001b[0m     \u001b[0mscalar_types\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mscalar_types\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1003\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1004\u001b[0;31m     \u001b[0mmaxa\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_can_coerce_all\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0marray_types\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1005\u001b[0m     \u001b[0mmaxsc\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_can_coerce_all\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mscalar_types\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1006\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.pyenv/versions/anaconda3-5.3.1/lib/python3.7/site-packages/numpy/core/numerictypes.py\u001b[0m in \u001b[0;36m_can_coerce_all\u001b[0;34m(dtypelist, start)\u001b[0m\n\u001b[1;32m    934\u001b[0m     \u001b[0;32mwhile\u001b[0m \u001b[0mthisind\u001b[0m \u001b[0;34m<\u001b[0m \u001b[0m__len_test_types\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    935\u001b[0m         \u001b[0mnewdtype\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdtype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0m__test_types\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mthisind\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 936\u001b[0;31m         \u001b[0mnumcoerce\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mx\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mdtypelist\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mnewdtype\u001b[0m \u001b[0;34m>=\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    937\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mnumcoerce\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0mN\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    938\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mnewdtype\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/.pyenv/versions/anaconda3-5.3.1/lib/python3.7/site-packages/numpy/core/numerictypes.py\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m    934\u001b[0m     \u001b[0;32mwhile\u001b[0m \u001b[0mthisind\u001b[0m \u001b[0;34m<\u001b[0m \u001b[0m__len_test_types\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    935\u001b[0m         \u001b[0mnewdtype\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdtype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0m__test_types\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mthisind\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 936\u001b[0;31m         \u001b[0mnumcoerce\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mx\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mdtypelist\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mnewdtype\u001b[0m \u001b[0;34m>=\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    937\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mnumcoerce\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0mN\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    938\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mnewdtype\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "X = np.zeros((len(train_df),1))\n",
    "molecule = None\n",
    "# def cal_euc(X,molecule,i,row):\n",
    "for i,row in tqdm(train_df.iterrows(),total=len(train_df)):\n",
    "#     print(row[1],row[2],row[3])\n",
    "    if row[1] != molecule:\n",
    "        molecule = row[1]\n",
    "        molecule_name = structure_df[structure_df['molecule_name'] == molecule]\n",
    "    \n",
    "    xyz_0 = molecule_name.values[row[2],3:6]\n",
    "    xyz_1 = molecule_name.values[row[3],3:6]\n",
    "    X[i,0] = np.linalg.norm(xyz_1-xyz_0)\n",
    "\n",
    "# Parallel(n_jobs=-1)([delayed(cal_euc)(X, molecule, i, row)for i,row in train_df.head().iterrows()])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[1.0919530596119005,\n",
       " 1.7831197560388008,\n",
       " 1.783147496403011,\n",
       " 1.7831566853296161,\n",
       " 1.0919516185813627]"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "distance"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>molecule_name</th>\n",
       "      <th>atom_index</th>\n",
       "      <th>atom</th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "      <th>z</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>0</td>\n",
       "      <td>C</td>\n",
       "      <td>-0.012698</td>\n",
       "      <td>1.085804</td>\n",
       "      <td>0.008001</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>1</td>\n",
       "      <td>H</td>\n",
       "      <td>0.002150</td>\n",
       "      <td>-0.006031</td>\n",
       "      <td>0.001976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>2</td>\n",
       "      <td>H</td>\n",
       "      <td>1.011731</td>\n",
       "      <td>1.463751</td>\n",
       "      <td>0.000277</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>3</td>\n",
       "      <td>H</td>\n",
       "      <td>-0.540815</td>\n",
       "      <td>1.447527</td>\n",
       "      <td>-0.876644</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>dsgdb9nsd_000001</td>\n",
       "      <td>4</td>\n",
       "      <td>H</td>\n",
       "      <td>-0.523814</td>\n",
       "      <td>1.437933</td>\n",
       "      <td>0.906397</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      molecule_name  atom_index atom         x         y         z\n",
       "0  dsgdb9nsd_000001           0    C -0.012698  1.085804  0.008001\n",
       "1  dsgdb9nsd_000001           1    H  0.002150 -0.006031  0.001976\n",
       "2  dsgdb9nsd_000001           2    H  1.011731  1.463751  0.000277\n",
       "3  dsgdb9nsd_000001           3    H -0.540815  1.447527 -0.876644\n",
       "4  dsgdb9nsd_000001           4    H -0.523814  1.437933  0.906397"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a = structure_df[structure_df['molecule_name'] == 'dsgdb9nsd_000001']\n",
    "a"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.002150416, -0.0060313176, 0.0019761204], dtype=object)"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a.values[1,3:6]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
